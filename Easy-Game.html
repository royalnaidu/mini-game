<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fun-Zone | Ultimate Game Hub</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      user-select: none;
    }
    body {
      background: linear-gradient(135deg, #191919, #1f1f1f);
      color: #fff;
      text-align: center;
      padding: 20px;
      min-height: 100vh;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 2.5rem;
      color: #00ffd5;
      text-shadow: 0 0 10px rgba(0, 255, 213, 0.5);
    }
    .login {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      margin-top: 30px;
    }
    input[type="text"] {
      padding: 10px 15px;
      border: 2px solid #00ffd5;
      border-radius: 12px;
      font-size: 1rem;
      margin-bottom: 15px;
      background: #2a2a2a;
      color: white;
      width: 250px;
      text-align: center;
    }
    button {
      background: #00ffd5;
      border: none;
      padding: 12px 25px;
      font-size: 1.1rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px #00ffd5;
      font-weight: bold;
      margin: 5px;
    }
    button:hover {
      background: #0ff;
      transform: scale(1.05);
    }
    .game-list {
      display: none;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-top: 30px;
    }
    .card {
      background: #2a2a2a;
      border-radius: 20px;
      padding: 20px;
      width: 220px;
      box-shadow: 0 0 15px rgba(0,255,213,0.2);
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(0,255,213,0.4);
    }
    .card h2 {
      margin-bottom: 10px;
      color: #00ffd5;
    }
    .game-area {
      display: none;
      margin-top: 20px;
    }
    #gameCanvas {
      background: #1a1a1a;
      border-radius: 15px;
      margin: 20px auto;
      display: block;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
    #ads {
      margin-top: 30px;
      padding: 10px;
      background: #111;
      border: 2px dashed #333;
      border-radius: 12px;
      color: #777;
    }
    .stats {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 15px 0;
    }
    .stat-box {
      background: #2a2a2a;
      padding: 10px 15px;
      border-radius: 10px;
      min-width: 100px;
    }
    .target {
      position: absolute;
      border-radius: 50%;
      background: red;
      cursor: pointer;
    }
    .color-options {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px auto;
      max-width: 500px;
    }
    .color-option {
      width: 80px;
      height: 80px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .color-option:hover {
      transform: scale(1.05);
    }
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      max-width: 400px;
      margin: 20px auto;
    }
    .memory-tile {
      width: 80px;
      height: 80px;
      background: #333;
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .memory-tile.flipped {
      background: #00ffd5;
      transform: rotateY(180deg);
    }
    .memory-tile.matched {
      background: #4CAF50;
      cursor: default;
    }
    .timer-bar {
      width: 100%;
      height: 10px;
      background: #333;
      border-radius: 5px;
      margin: 10px 0;
      overflow: hidden;
    }
    .timer-progress {
      height: 100%;
      background: #00ffd5;
      width: 100%;
      transition: width 1s linear;
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-5px); }
      40%, 80% { transform: translateX(5px); }
    }
    .shake {
      animation: shake 0.5s;
    }
    .sequence-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .sequence-number {
      width: 60px;
      height: 60px;
      background: #00ffd5;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      color: #111;
    }
    .sequence-input {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .sequence-input button {
      width: 50px;
      height: 50px;
      font-size: 20px;
      padding: 0;
    }
    .pattern-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      max-width: 300px;
      margin: 20px auto;
    }
    .pattern-cell {
      width: 50px;
      height: 50px;
      background: #333;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .pattern-cell.active {
      background: #00ffd5;
    }
    .reaction-box {
      width: 200px;
      height: 200px;
      background: #333;
      margin: 30px auto;
      border-radius: 15px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background 0.3s;
    }
    .reaction-box.waiting {
      background: #FF5733;
    }
    .reaction-box.ready {
      background: #33FF57;
    }
    .game-2048 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      max-width: 400px;
      margin: 20px auto;
      background: #333;
      padding: 10px;
      border-radius: 10px;
    }
    .tile {
      width: 80px;
      height: 80px;
      background: #444;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
    }
    .tile-2 { background: #EEE4DA; color: #776E65; }
    .tile-4 { background: #EDE0C8; color: #776E65; }
    .tile-8 { background: #F2B179; color: white; }
    .tile-16 { background: #F59563; color: white; }
    .tile-32 { background: #F67C5F; color: white; }
    .tile-64 { background: #F65E3B; color: white; }
    .tile-128 { background: #EDCF72; color: white; font-size: 20px; }
    .tile-256 { background: #EDCC61; color: white; font-size: 20px; }
    .tile-512 { background: #EDC850; color: white; font-size: 20px; }
    .tile-1024 { background: #EDC53F; color: white; font-size: 16px; }
    .tile-2048 { background: #EDC22E; color: white; font-size: 16px; }
    .difference-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px auto;
      max-width: 800px;
    }
    .difference-image {
      position: relative;
      width: 350px;
      height: 250px;
      background-size: cover;
      border-radius: 10px;
      cursor: crosshair;
    }
    .difference-marker {
      position: absolute;
      width: 20px;
      height: 20px;
      background: rgba(255, 0, 0, 0.7);
      border-radius: 50%;
      transform: translate(-10px, -10px);
    }
    .sound-options {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px auto;
      max-width: 500px;
    }
    .sound-option {
      width: 100px;
      height: 100px;
      background: #333;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    .sound-option:hover {
      background: #00ffd5;
      transform: scale(1.05);
    }
    .sound-emoji {
      font-size: 30px;
    }
    .controls {
      margin: 20px 0;
    }
    .controls button {
      margin: 0 5px;
    }
    .ad-container {
      margin: 20px auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    .ad-banner {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>🎮 Ultimate Fun-Zone 🎯</h1>
  
  <div class="login">
    <input type="text" id="username" placeholder="Enter your name" maxlength="15" />
    <button onclick="startGameHub()">Enter Game Hub</button>
  </div>

  <!-- Banner Ads Section -->
  <div class="ad-container">
    <!-- Banner Ad 1 -->
    <div class="ad-banner">
      <script type="text/javascript">
        atOptions = {
          'key' : 'a8b74382457fbded37b3cf5364ce7c66',
          'format' : 'iframe',
          'height' : 60,
          'width' : 468,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/a8b74382457fbded37b3cf5364ce7c66/invoke.js"></script>
    </div>
    
    <!-- Banner Ad 2 -->
    <div class="ad-banner">
      <script type="text/javascript">
        atOptions = {
          'key' : 'b27233a6a047f3bd148e6f3615eaa61c',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/b27233a6a047f3bd148e6f3615eaa61c/invoke.js"></script>
    </div>
  </div>
  
  <div class="game-list" id="gameList">
    <!-- Previous Games -->
    <div class="card" onclick="launchGame('click')">
      <h2>Click Counter</h2>
      <p>Click as fast as you can in 10 seconds!</p>
    </div>
    <div class="card" onclick="launchGame('target')">
      <h2>Tap the Target</h2>
      <p>Hit 20 randomly appearing targets!</p>
    </div>
    <div class="card" onclick="launchGame('color')">
      <h2>Color Match</h2>
      <p>Find the matching color in 3 tries!</p>
    </div>
    <div class="card" onclick="launchGame('memory')">
      <h2>Memory Tiles</h2>
      <p>Match all pairs before time runs out!</p>
    </div>
    <div class="card" onclick="launchGame('typing')">
      <h2>Typing Test</h2>
      <p>Type the words as fast as you can!</p>
    </div>
    <div class="card" onclick="launchGame('math')">
      <h2>Math Challenge</h2>
      <p>Solve math problems quickly!</p>
    </div>
    
    <!-- New Games -->
    <div class="card" onclick="launchGame('sequence')">
      <h2>Number Sequence</h2>
      <p>Memorize and repeat the number pattern!</p>
    </div>
    <div class="card" onclick="launchGame('pattern')">
      <h2>Pattern Memory</h2>
      <p>Remember and recreate the pattern!</p>
    </div>
    <div class="card" onclick="launchGame('reaction')">
      <h2>Reaction Timer</h2>
      <p>Test your reaction speed!</p>
    </div>
    <div class="card" onclick="launchGame('2048')">
      <h2>2048 Clone</h2>
      <p>Slide tiles to combine them!</p>
    </div>
    <div class="card" onclick="launchGame('difference')">
      <h2>Spot the Difference</h2>
      <p>Find all differences between images!</p>
    </div>
    <div class="card" onclick="launchGame('sound')">
      <h2>Sound Match</h2>
      <p>Match the sounds to win!</p>
    </div>
  </div>
  
  <div class="game-area" id="gameArea">
    <h2 id="gameTitle">Game</h2>
    <div class="stats">
      <div class="stat-box">Score: <span id="score">0</span></div>
      <div class="stat-box">Time: <span id="time">0</span>s</div>
      <div class="stat-box">High Score: <span id="highScore">0</span></div>
    </div>
    <div class="timer-bar" id="timerBar" style="display: none;">
      <div class="timer-progress" id="timerProgress"></div>
    </div>
    <div id="gameContent"></div>
    <button onclick="goBack()">🔙 Back to Games</button>
  </div>
  
  <div id="ads">Additional Advertisement Space</div>

  <script>
    let user = "";
    let currentGame = null;
    let gameInterval = null;
    let score = 0;
    let timeLeft = 0;
    let highScore = 0;
    
    // Game data
    const colors = ['#FF5733', '#33FF57', '#3357FF', '#F3FF33', '#FF33F3', '#33FFF3'];
    const memorySymbols = ['🐶', '🐱', '🐭', '🐹', '🐰', '🦊', '🐻', '🐼'];
    const typingWords = ['code', 'game', 'fun', 'quick', 'brown', 'fox', 'jumps', 'lazy', 'dog'];
    const mathOperations = ['+', '-', '*'];
    const soundEmojis = ['🔔', '🎵', '🎶', '📢', '🎸', '🎷', '🥁', '🎻'];
    const soundNames = ['Bell', 'Melody', 'Tune', 'Horn', 'Guitar', 'Sax', 'Drum', 'Violin'];
    
    // Image differences coordinates (x, y)
    const differences = [
      {x: 120, y: 80}, {x: 250, y: 150}, {x: 180, y: 200},
      {x: 90, y: 40}, {x: 300, y: 180}
    ];
    
    function startGameHub() {
      user = document.getElementById("username").value.trim();
      if (user === "") {
        alert("Please enter your name!");
        document.getElementById("username").classList.add('shake');
        setTimeout(() => document.getElementById("username").classList.remove('shake'), 500);
        return;
      }
      document.querySelector(".login").style.display = "none";
      document.getElementById("gameList").style.display = "flex";
    }
    
    function launchGame(type) {
      currentGame = type;
      score = 0;
      document.getElementById("gameList").style.display = "none";
      document.getElementById("gameTitle").innerText = getGameTitle(type);
      document.getElementById("gameArea").style.display = "block";
      document.getElementById("score").innerText = score;
      document.getElementById("gameContent").innerHTML = '';
      document.getElementById("timerBar").style.display = "none";
      
      // Load high score
      const key = `${user}_${type}`;
      highScore = localStorage.getItem(key) || 0;
      document.getElementById("highScore").innerText = highScore;
      
      // Initialize game
      switch(type) {
        case 'click':
          setupClickGame();
          break;
        case 'target':
          setupTargetGame();
          break;
        case 'color':
          setupColorGame();
          break;
        case 'memory':
          setupMemoryGame();
          break;
        case 'typing':
          setupTypingGame();
          break;
        case 'math':
          setupMathGame();
          break;
        case 'sequence':
          setupSequenceGame();
          break;
        case 'pattern':
          setupPatternGame();
          break;
        case 'reaction':
          setupReactionGame();
          break;
        case '2048':
          setup2048Game();
          break;
        case 'difference':
          setupDifferenceGame();
          break;
        case 'sound':
          setupSoundGame();
          break;
      }
    }
    
    function getGameTitle(type) {
      const titles = {
        'click': 'Click Counter',
        'target': 'Tap the Target',
        'color': 'Color Match',
        'memory': 'Memory Tiles',
        'typing': 'Typing Test',
        'math': 'Math Challenge',
        'sequence': 'Number Sequence',
        'pattern': 'Pattern Memory',
        'reaction': 'Reaction Timer',
        '2048': '2048 Game',
        'difference': 'Spot the Difference',
        'sound': 'Sound Match'
      };
      return titles[type];
    }
    
    // Click Counter Game
    function setupClickGame() {
      timeLeft = 10;
      document.getElementById("time").innerText = timeLeft;
      document.getElementById("timerBar").style.display = "block";
      document.getElementById("timerProgress").style.width = "100%";
      
      const gameContent = document.getElementById("gameContent");
      gameContent.innerHTML = `
        <button id="clickButton" style="font-size: 1.5rem; padding: 20px 40px;">CLICK ME!</button>
        <p>Click the button as many times as you can in 10 seconds!</p>
      `;
      
      const clickButton = document.getElementById("clickButton");
      clickButton.onclick = () => {
        score++;
        document.getElementById("score").innerText = score;
      };
      
      // Timer
      gameInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        document.getElementById("timerProgress").style.width = `${(timeLeft / 10) * 100}%`;
        
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          clickButton.disabled = true;
          finishGame();
        }
      }, 1000);
    }
    
    // Tap the Target Game
    function setupTargetGame() {
      timeLeft = 30;
      document.getElementById("time").innerText = timeLeft;
      document.getElementById("timerBar").style.display = "block";
      document.getElementById("timerProgress").style.width = "100%";
      
      const gameContent = document.getElementById("gameContent");
      gameContent.innerHTML = `
        <p>Tap the red targets that appear! You need 20 hits.</p>
        <div style="position: relative; height: 400px; width: 100%; border: 2px dashed #444; border-radius: 10px; overflow: hidden;" id="targetArea"></div>
      `;
      
      const targetArea = document.getElementById("targetArea");
      let targetsHit = 0;
      
      function createTarget() {
        const target = document.createElement("div");
        target.className = "target";
        const size = Math.random() * 50 + 30;
        target.style.width = `${size}px`;
        target.style.height = `${size}px`;
        
        const x = Math.random() * (targetArea.offsetWidth - size);
        const y = Math.random() * (targetArea.offsetHeight - size);
        target.style.left = `${x}px`;
        target.style.top = `${y}px`;
        
        target.onclick = () => {
          target.remove();
          targetsHit++;
          score += 10;
          document.getElementById("score").innerText = score;
          
          if (targetsHit >= 20) {
            finishGame();
          } else {
            setTimeout(createTarget, Math.random() * 500 + 300);
          }
        };
        
        targetArea.appendChild(target);
      }
      
      // Initial target
      createTarget();
      
      // Timer
      gameInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        document.getElementById("timerProgress").style.width = `${(timeLeft / 30) * 100}%`;
        
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          finishGame();
        }
      }, 1000);
    }
    
    // Color Match Game
    function setupColorGame() {
      const correctColor = colors[Math.floor(Math.random() * colors.length)];
      let attempts = 0;
      const maxAttempts = 3;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Find this color: <span style="display: inline-block; width: 30px; height: 30px; background: ${correctColor}; border: 2px solid white;"></span></p>
        <p>Attempts left: <span id="attemptsLeft">${maxAttempts}</span></p>
        <div class="color-options"></div>
      `;
      
      const optionsContainer = document.querySelector(".color-options");
      const shuffledColors = [...colors].sort(() => Math.random() - 0.5);
      
      shuffledColors.forEach(color => {
        const option = document.createElement("div");
        option.className = "color-option";
        option.style.background = color;
        option.onclick = () => {
          attempts++;
          document.getElementById("attemptsLeft").innerText = maxAttempts - attempts;
          
          if (color === correctColor) {
            score += 100 - (attempts * 20);
            document.getElementById("score").innerText = score;
            optionsContainer.innerHTML = `<p style="color: #00ffd5; font-size: 1.5rem;">Correct! 🎉</p>`;
            setTimeout(finishGame, 1000);
          } else {
            option.classList.add('shake');
            setTimeout(() => option.classList.remove('shake'), 500);
            
            if (attempts >= maxAttempts) {
              optionsContainer.innerHTML = `<p style="color: #ff3333;">Game Over! The color was ${correctColor}</p>`;
              setTimeout(finishGame, 1500);
            }
          }
        };
        optionsContainer.appendChild(option);
      });
    }
    
    // Memory Tiles Game
    function setupMemoryGame() {
      timeLeft = 60;
      document.getElementById("time").innerText = timeLeft;
      document.getElementById("timerBar").style.display = "block";
      document.getElementById("timerProgress").style.width = "100%";
      
      // Create pairs (8 pairs for 4x4 grid)
      const symbols = [...memorySymbols, ...memorySymbols].sort(() => Math.random() - 0.5);
      let flippedTiles = [];
      let matchedPairs = 0;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Match all pairs before time runs out!</p>
        <div class="memory-grid"></div>
      `;
      
      const grid = document.querySelector(".memory-grid");
      grid.innerHTML = '';
      
      symbols.forEach((symbol, index) => {
        const tile = document.createElement("div");
        tile.className = "memory-tile";
        tile.dataset.index = index;
        tile.dataset.symbol = symbol;
        tile.onclick = () => flipTile(tile);
        grid.appendChild(tile);
      });
      
      function flipTile(tile) {
        if (flippedTiles.length >= 2 || tile.classList.contains('flipped') || tile.classList.contains('matched')) {
          return;
        }
        
        tile.classList.add('flipped');
        tile.textContent = tile.dataset.symbol;
        flippedTiles.push(tile);
        
        if (flippedTiles.length === 2) {
          checkForMatch();
        }
      }
      
      function checkForMatch() {
        const [tile1, tile2] = flippedTiles;
        
        if (tile1.dataset.symbol === tile2.dataset.symbol) {
          tile1.classList.add('matched');
          tile2.classList.add('matched');
          flippedTiles = [];
          matchedPairs++;
          score += 50;
          document.getElementById("score").innerText = score;
          
          if (matchedPairs === memorySymbols.length) {
            score += timeLeft * 5;
            document.getElementById("score").innerText = score;
            finishGame();
          }
        } else {
          setTimeout(() => {
            tile1.classList.remove('flipped');
            tile2.classList.remove('flipped');
            tile1.textContent = '';
            tile2.textContent = '';
            flippedTiles = [];
          }, 1000);
        }
      }
      
      // Timer
      gameInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        document.getElementById("timerProgress").style.width = `${(timeLeft / 60) * 100}%`;
        
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          finishGame();
        }
      }, 1000);
    }
    
    // Typing Test Game
    function setupTypingGame() {
      timeLeft = 30;
      document.getElementById("time").innerText = timeLeft;
      document.getElementById("timerBar").style.display = "block";
      document.getElementById("timerProgress").style.width = "100%";
      
      let currentWord = '';
      let wordsTyped = 0;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Type the word shown below:</p>
        <h3 id="wordToType" style="font-size: 2rem; margin: 20px 0; letter-spacing: 2px;"></h3>
        <input type="text" id="typingInput" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="font-size: 1.2rem; padding: 10px; width: 200px;">
        <p>Words typed: <span id="wordsTyped">0</span></p>
      `;
      
      const wordDisplay = document.getElementById("wordToType");
      const typingInput = document.getElementById("typingInput");
      
      function newWord() {
        currentWord = typingWords[Math.floor(Math.random() * typingWords.length)];
        wordDisplay.textContent = currentWord;
        typingInput.value = '';
        typingInput.focus();
      }
      
      typingInput.addEventListener('input', () => {
        if (typingInput.value === currentWord) {
          wordsTyped++;
          score += 10;
          document.getElementById("wordsTyped").textContent = wordsTyped;
          document.getElementById("score").textContent = score;
          newWord();
        }
      });
      
      newWord();
      
      // Timer
      gameInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        document.getElementById("timerProgress").style.width = `${(timeLeft / 30) * 100}%`;
        
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          typingInput.disabled = true;
          finishGame();
        }
      }, 1000);
    }
    
    // Math Challenge Game
    function setupMathGame() {
      timeLeft = 60;
      document.getElementById("time").innerText = timeLeft;
      document.getElementById("timerBar").style.display = "block";
      document.getElementById("timerProgress").style.width = "100%";
      
      let currentProblem = '';
      let correctAnswer = 0;
      let problemsSolved = 0;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Solve the math problem:</p>
        <h3 id="mathProblem" style="font-size: 2rem; margin: 20px 0;"></h3>
        <input type="number" id="mathAnswer" autocomplete="off" style="font-size: 1.2rem; padding: 10px; width: 100px;">
        <button onclick="checkMathAnswer()">Submit</button>
        <p>Problems solved: <span id="problemsSolved">0</span></p>
      `;
      
      newProblem();
      
      // Timer
      gameInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("time").innerText = timeLeft;
        document.getElementById("timerProgress").style.width = `${(timeLeft / 60) * 100}%`;
        
        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          document.getElementById("mathAnswer").disabled = true;
          finishGame();
        }
      }, 1000);
      
      window.checkMathAnswer = () => {
        const userAnswer = parseInt(document.getElementById("mathAnswer").value);
        if (userAnswer === correctAnswer) {
          score += 20;
          document.getElementById("score").textContent = score;
          problemsSolved++;
          document.getElementById("problemsSolved").textContent = problemsSolved;
          document.getElementById("mathAnswer").value = '';
          newProblem();
        } else {
          alert("Incorrect! Try again.");
          document.getElementById("mathAnswer").value = '';
          document.getElementById("mathAnswer").focus();
        }
      };
      
      function newProblem() {
        const num1 = Math.floor(Math.random() * 10) + 1;
        const num2 = Math.floor(Math.random() * 10) + 1;
        const operation = mathOperations[Math.floor(Math.random() * mathOperations.length)];
        
        switch(operation) {
          case '+':
            correctAnswer = num1 + num2;
            break;
          case '-':
            correctAnswer = num1 - num2;
            break;
          case '*':
            correctAnswer = num1 * num2;
            break;
        }
        
        currentProblem = `${num1} ${operation} ${num2} = ?`;
        document.getElementById("mathProblem").textContent = currentProblem;
        document.getElementById("mathAnswer").focus();
      }
    }
    
    // Number Sequence Game
    function setupSequenceGame() {
      let sequence = [];
      let userSequence = [];
      let level = 1;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Memorize the number sequence and repeat it!</p>
        <div class="sequence-container" id="sequenceDisplay"></div>
        <div class="sequence-input" id="sequenceInput"></div>
        <p>Level: <span id="level">1</span></p>
      `;
      
      const sequenceDisplay = document.getElementById("sequenceDisplay");
      const sequenceInput = document.getElementById("sequenceInput");
      
      // Create number buttons
      for (let i = 1; i <= 9; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.onclick = () => checkSequence(i);
        sequenceInput.appendChild(btn);
      }
      
      startSequenceLevel();
      
      function startSequenceLevel() {
        sequence = [];
        userSequence = [];
        sequenceDisplay.innerHTML = '';
        
        // Generate sequence
        for (let i = 0; i < level + 2; i++) {
          sequence.push(Math.floor(Math.random() * 9) + 1);
        }
        
        // Display sequence
        sequence.forEach((num, index) => {
          setTimeout(() => {
            const numDiv = document.createElement("div");
            numDiv.className = "sequence-number";
            numDiv.textContent = num;
            sequenceDisplay.appendChild(numDiv);
            
            setTimeout(() => {
              sequenceDisplay.removeChild(numDiv);
            }, 1000);
          }, index * 1500);
        });
        
        // Enable input after sequence is shown
        setTimeout(() => {
          sequenceInput.querySelectorAll("button").forEach(btn => btn.disabled = false);
        }, sequence.length * 1500);
      }
      
      function checkSequence(num) {
        userSequence.push(num);
        
        if (userSequence[userSequence.length - 1] !== sequence[userSequence.length - 1]) {
          finishGame();
          return;
        }
        
        if (userSequence.length === sequence.length) {
          score += level * 10;
          document.getElementById("score").innerText = score;
          level++;
          document.getElementById("level").innerText = level;
          setTimeout(startSequenceLevel, 1000);
        }
      }
    }
    
    // Pattern Memory Game
    function setupPatternGame() {
      let pattern = [];
      let userPattern = [];
      let level = 1;
      const gridSize = 5;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Memorize the pattern and recreate it!</p>
        <div class="pattern-grid" id="patternGrid"></div>
        <p>Level: <span id="level">1</span></p>
        <button id="checkPattern" onclick="checkPattern()">Check Pattern</button>
      `;
      
      const patternGrid = document.getElementById("patternGrid");
      
      // Create grid
      for (let i = 0; i < gridSize * gridSize; i++) {
        const cell = document.createElement("div");
        cell.className = "pattern-cell";
        cell.dataset.index = i;
        cell.onclick = () => {
          cell.classList.toggle('active');
          userPattern[i] = cell.classList.contains('active');
        };
        patternGrid.appendChild(cell);
      }
      
      startPatternLevel();
      
      function startPatternLevel() {
        pattern = Array(gridSize * gridSize).fill(false);
        userPattern = Array(gridSize * gridSize).fill(false);
        
        // Generate pattern
        const activeCells = Math.min(level + 2, gridSize * gridSize);
        let cellsActivated = 0;
        
        while (cellsActivated < activeCells) {
          const randomIndex = Math.floor(Math.random() * (gridSize * gridSize));
          if (!pattern[randomIndex]) {
            pattern[randomIndex] = true;
            cellsActivated++;
          }
        }
        
        // Show pattern
        pattern.forEach((active, index) => {
          const cell = patternGrid.children[index];
          if (active) cell.classList.add('active');
          else cell.classList.remove('active');
        });
        
        // Disable clicking during display
        patternGrid.style.pointerEvents = 'none';
        
        // Hide pattern after 2 seconds
        setTimeout(() => {
          patternGrid.querySelectorAll('.pattern-cell').forEach(cell => {
            cell.classList.remove('active');
          });
          patternGrid.style.pointerEvents = 'auto';
        }, 2000);
      }
      
      window.checkPattern = function() {
        let correct = true;
        for (let i = 0; i < pattern.length; i++) {
          if (pattern[i] !== userPattern[i]) {
            correct = false;
            break;
          }
        }
        
        if (correct) {
          score += level * 15;
          document.getElementById("score").innerText = score;
          level++;
          document.getElementById("level").innerText = level;
          setTimeout(startPatternLevel, 1000);
        } else {
          finishGame();
        }
      };
    }
    
    // Reaction Timer Game
    function setupReactionGame() {
      let startTime;
      let round = 0;
      const maxRounds = 5;
      let reactionTimes = [];
      
      document.getElementById("gameContent").innerHTML = `
        <p>Click when the box turns green!</p>
        <div class="reaction-box" id="reactionBox">Wait for red...</div>
        <p>Round: <span id="round">1</span>/5</p>
        <p>Average: <span id="average">-</span> ms</p>
      `;
      
      const reactionBox = document.getElementById("reactionBox");
      
      startReactionRound();
      
      function startReactionRound() {
        round++;
        document.getElementById("round").textContent = `${round}/${maxRounds}`;
        reactionBox.className = "reaction-box waiting";
        reactionBox.textContent = "Wait for red...";
        
        // Random delay between 1-3 seconds
        const delay = Math.random() * 2000 + 1000;
        
        setTimeout(() => {
          reactionBox.className = "reaction-box ready";
          reactionBox.textContent = "CLICK NOW!";
          startTime = Date.now();
        }, delay);
        
        reactionBox.onclick = function() {
          if (reactionBox.className.includes('ready')) {
            const reactionTime = Date.now() - startTime;
            reactionTimes.push(reactionTime);
            
            // Calculate average
            const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);
            document.getElementById("average").textContent = avg;
            
            if (round < maxRounds) {
              setTimeout(startReactionRound, 1000);
            } else {
              score = 5000 - avg;
              document.getElementById("score").textContent = score;
              setTimeout(finishGame, 1000);
            }
          } else {
            reactionBox.textContent = "Too early! Wait...";
            setTimeout(() => {
              reactionBox.textContent = "Wait for red...";
            }, 1000);
          }
        };
      }
    }
    
    // 2048 Game
    function setup2048Game() {
      let board = [
        [0, 0, 0, 0],
        [0, 0, 0, 0],
        [0, 0, 0, 0],
        [0, 0, 0, 0]
      ];
      
      document.getElementById("gameContent").innerHTML = `
        <p>Use arrow keys to slide tiles. Combine tiles to get 2048!</p>
        <div class="game-2048" id="game2048"></div>
        <div class="controls">
          <button onclick="moveTiles('up')">↑</button>
          <button onclick="moveTiles('left')">←</button>
          <button onclick="moveTiles('down')">↓</button>
          <button onclick="moveTiles('right')">→</button>
        </div>
      `;
      
      const gameContainer = document.getElementById("game2048");
      
      // Initialize board
      renderBoard();
      addRandomTile();
      addRandomTile();
      
      // Keyboard controls
      window.onkeydown = function(e) {
        if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
          e.preventDefault();
          const direction = e.key.replace('Arrow', '').toLowerCase();
          moveTiles(direction);
        }
      };
      
      window.moveTiles = function(direction) {
        let moved = false;
        const oldBoard = JSON.stringify(board);
        
        // Process movement
        switch(direction) {
          case 'up':
            for (let col = 0; col < 4; col++) {
              const column = [board[0][col], board[1][col], board[2][col], board[3][col]];
              const newColumn = slideTiles(column);
              for (let row = 0; row < 4; row++) {
                board[row][col] = newColumn[row];
              }
            }
            break;
          case 'down':
            for (let col = 0; col < 4; col++) {
              const column = [board[3][col], board[2][col], board[1][col], board[0][col]];
              const newColumn = slideTiles(column);
              for (let row = 0; row < 4; row++) {
                board[row][col] = newColumn[3 - row];
              }
            }
            break;
          case 'left':
            for (let row = 0; row < 4; row++) {
              board[row] = slideTiles(board[row]);
            }
            break;
          case 'right':
            for (let row = 0; row < 4; row++) {
              board[row] = slideTiles([...board[row]].reverse()).reverse();
            }
            break;
        }
        
        // Check if board changed
        if (JSON.stringify(board) !== oldBoard) {
          addRandomTile();
          renderBoard();
          
          // Check for win
          if (board.some(row => row.includes(2048))) {
            score += 10000;
            document.getElementById("score").textContent = score;
            setTimeout(() => {
              alert("Congratulations! You reached 2048!");
              finishGame();
            }, 500);
          }
          
          // Check for game over
          if (!hasValidMoves()) {
            setTimeout(() => {
              alert("Game Over! No more moves.");
              finishGame();
            }, 500);
          }
        }
      };
      
      function slideTiles(line) {
        // Remove zeros
        let filtered = line.filter(x => x !== 0);
        
        // Merge tiles
        for (let i = 0; i < filtered.length - 1; i++) {
          if (filtered[i] === filtered[i + 1]) {
            filtered[i] *= 2;
            score += filtered[i];
            document.getElementById("score").textContent = score;
            filtered.splice(i + 1, 1);
          }
        }
        
        // Add zeros back
        while (filtered.length < 4) {
          filtered.push(0);
        }
        
        return filtered;
      }
      
      function addRandomTile() {
        const emptyCells = [];
        for (let row = 0; row < 4; row++) {
          for (let col = 0; col < 4; col++) {
            if (board[row][col] === 0) {
              emptyCells.push({row, col});
            }
          }
        }
        
        if (emptyCells.length > 0) {
          const {row, col} = emptyCells[Math.floor(Math.random() * emptyCells.length)];
          board[row][col] = Math.random() < 0.9 ? 2 : 4;
        }
      }
      
      function renderBoard() {
        gameContainer.innerHTML = '';
        for (let row = 0; row < 4; row++) {
          for (let col = 0; col < 4; col++) {
            const tile = document.createElement("div");
            tile.className = "tile";
            if (board[row][col] > 0) {
              tile.classList.add(`tile-${board[row][col]}`);
              tile.textContent = board[row][col];
            }
            gameContainer.appendChild(tile);
          }
        }
      }
      
      function hasValidMoves() {
        // Check for empty cells
        for (let row = 0; row < 4; row++) {
          for (let col = 0; col < 4; col++) {
            if (board[row][col] === 0) return true;
          }
        }
        
        // Check for possible merges
        for (let row = 0; row < 4; row++) {
          for (let col = 0; col < 4; col++) {
            if (col < 3 && board[row][col] === board[row][col + 1]) return true;
            if (row < 3 && board[row][col] === board[row + 1][col]) return true;
          }
        }
        
        return false;
      }
    }
    
    // Spot the Difference Game
    function setupDifferenceGame() {
      let foundDifferences = 0;
      const totalDifferences = differences.length;
      
      document.getElementById("gameContent").innerHTML = `
        <p>Find all ${totalDifferences} differences between the images!</p>
        <div class="difference-container">
          <div class="difference-image" id="image1" style="background-image: url('https://via.placeholder.com/350x250/333/fff?text=Image+1')"></div>
          <div class="difference-image" id="image2" style="background-image: url('https://via.placeholder.com/350x250/333/fff?text=Image+2')"></div>
        </div>
        <p>Found: <span id="found">0</span>/${totalDifferences}</p>
      `;
      
      const image1 = document.getElementById("image1");
      const image2 = document.getElementById("image2");
      
      image1.onclick = function(e) {
        checkDifference(e, this);
      };
      
      image2.onclick = function(e) {
        checkDifference(e, this);
      };
      
      function checkDifference(event, element) {
        const rect = element.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        
        // Check if click is near any difference
        for (let i = 0; i < differences.length; i++) {
          const diff = differences[i];
          const distance = Math.sqrt(Math.pow(x - diff.x, 2) + Math.pow(y - diff.y, 2));
          
          if (distance < 20) { // Within 20px radius
            // Mark this difference as found
            if (!diff.found) {
              diff.found = true;
              foundDifferences++;
              document.getElementById("found").textContent = foundDifferences;
              
              // Add marker
              const marker = document.createElement("div");
              marker.className = "difference-marker";
              marker.style.left = `${diff.x}px`;
              marker.style.top = `${diff.y}px`;
              element.appendChild(marker);
              
              // Update score
              score += 100;
              document.getElementById("score").textContent = score;
              
              // Check if all found
              if (foundDifferences === totalDifferences) {
                setTimeout(finishGame, 1000);
              }
            }
            return;
          }
        }
      }
    }
    
    // Sound Match Game
    function setupSoundGame() {
      let sounds = [];
      let flippedCards = [];
      let matchedPairs = 0;
      const totalPairs = 4;
      
      // Create pairs of sounds
      const soundPairs = [];
      for (let i = 0; i < totalPairs; i++) {
        soundPairs.push(i);
        soundPairs.push(i);
      }
      
      // Shuffle sounds
      soundPairs.sort(() => Math.random() - 0.5);
      
      document.getElementById("gameContent").innerHTML = `
        <p>Match the pairs of sounds!</p>
        <div class="sound-options" id="soundOptions"></div>
      `;
      
      const soundOptions = document.getElementById("soundOptions");
      
      // Create sound cards
      soundPairs.forEach((soundIndex, index) => {
        const soundCard = document.createElement("div");
        soundCard.className = "sound-option";
        soundCard.dataset.soundIndex = soundIndex;
        soundCard.dataset.cardIndex = index;
        soundCard.onclick = () => flipSoundCard(soundCard);
        
        const emoji = document.createElement("div");
        emoji.className = "sound-emoji";
        emoji.textContent = "🔊";
        soundCard.appendChild(emoji);
        
        soundOptions.appendChild(soundCard);
        sounds.push({
          element: soundCard,
          soundIndex: soundIndex,
          flipped: false,
          matched: false
        });
      });
      
      function flipSoundCard(card) {
        const cardIndex = parseInt(card.dataset.cardIndex);
        const sound = sounds[cardIndex];
        
        // Don't flip if already flipped or matched
        if (sound.flipped || sound.matched || flippedCards.length >= 2) return;
        
        // Flip card
        sound.flipped = true;
        card.querySelector('.sound-emoji').textContent = soundEmojis[sound.soundIndex];
        card.style.background = '#00ffd5';
        flippedCards.push(sound);
        
        // Play sound (simulated in this example)
        // In a real implementation, you would play actual sounds here
        
        // Check for match if two cards are flipped
        if (flippedCards.length === 2) {
          if (flippedCards[0].soundIndex === flippedCards[1].soundIndex) {
            // Match found
            flippedCards[0].matched = true;
            flippedCards[1].matched = true;
            flippedCards[0].element.style.background = '#4CAF50';
            flippedCards[1].element.style.background = '#4CAF50';
            flippedCards = [];
            matchedPairs++;
            
            // Update score
            score += 50;
            document.getElementById("score").textContent = score;
            
            // Check if game is complete
            if (matchedPairs === totalPairs) {
              setTimeout(finishGame, 1000);
            }
          } else {
            // No match
            setTimeout(() => {
              flippedCards[0].flipped = false;
              flippedCards[1].flipped = false;
              flippedCards[0].element.querySelector('.sound-emoji').textContent = "🔊";
              flippedCards[1].element.querySelector('.sound-emoji').textContent = "🔊";
              flippedCards[0].element.style.background = '#333';
              flippedCards[1].element.style.background = '#333';
              flippedCards = [];
            }, 1000);
          }
        }
      }
    }
    
    function finishGame() {
      if (gameInterval) clearInterval(gameInterval);
      
      const key = `${user}_${currentGame}`;
      if (score > highScore) {
        highScore = score;
        localStorage.setItem(key, highScore);
        document.getElementById("highScore").innerText = highScore;
      }
      
      document.getElementById("gameContent").innerHTML += `
        <div style="margin: 20px 0; padding: 15px; background: rgba(0,255,213,0.1); border-radius: 10px;">
          <h3 style="color: #00ffd5;">Game Over!</h3>
          <p>Your score: ${score}</p>
          ${score > highScore ? '<p style="color: gold;">🎉 New High Score! 🎉</p>' : ''}
          <button onclick="launchGame('${currentGame}')" style="margin-top: 10px;">Play Again</button>
        </div>
      `;
    }
    
    function goBack() {
      if (gameInterval) clearInterval(gameInterval);
      document.getElementById("gameArea").style.display = "none";
      document.getElementById("gameList").style.display = "flex";
    }
  </script>
</body>
</html>